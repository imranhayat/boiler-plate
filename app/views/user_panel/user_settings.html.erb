<div class="container mt-2">
  <% if @subscription.present? %>
    <h3>Your Subscription Plan</h3>
    <%= @plan.nickname %> (<%= @plan.amount %> <%= @plan.currency %>)
    <hr>
    <h4>Subscription Details</h4>
    <p>You Purchased this subscription on : <%= Time.at(@subscription.current_period_start).to_datetime.strftime('%d %B %Y (%A) on %H:%M %P') %></p>
    <p>Your current subscription will end on : <%= Time.at(@subscription.current_period_end).to_datetime.strftime('%d %B %Y (%A) on %H:%M %P') %></p>
    <%= link_to 'Cancel Subscription Now', cancel_subscription_now_path, class: 'btn btn-primary btn-sm mt-2' %>
    <% if @subscription.cancel_at_period_end? %>
      <%= link_to 'Allow Renewal of Subscription', setup_renewal_of_subscription_path, class: 'btn btn-primary btn-sm mt-2' %>
      <p class="mark mt-1">You have cancelled the renewal of your subscription!</p>
    <% else %>
      <%= link_to 'Cancel Renewal of Subscription', setup_renewal_of_subscription_path, class: 'btn btn-primary btn-sm mt-2' %>
    <% end %>
    <hr>
  <% else %>
    <h3>No Subscription Present.</h3>
  <% end %>
  <% if current_user.stripe_customer_id? && current_user.stripe_payment_method_id? %>
    <h4>Card Details</h4>
    <p>Brand: (<%= @card_details[:brand] %>) | Expiry: (<%= [@card_details[:exp_month], @card_details[:exp_year]].join('/') %>)</p>
    <label for="card_number">Card Number</label>
    <input type="text" class="form-control mb-3" disabled value="**** **** **** <%= @card_details[:last4] %>">
  <% end %>
  <%= link_to 'Add or Update Card', update_card_details_path, remote: true, class: 'btn btn-primary btn-sm mt-2' %>
</div>